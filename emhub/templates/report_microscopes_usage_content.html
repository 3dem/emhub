<div class="row col-12">
      <!-- Overall table -->
        <div class="col-6">

            <div class="row">

                <!-- Overall table -->
                <div class="card  col-12">
                    <div class="card-header">
                        <h3>Instruments Usage ( {{ metric }} )</h3>
                    </div>
                    <div class="card-body">
                        <div class="table-responsive">
                            <table id="table-overall" class="table table-striped table-bordered" style="width:100%">
                                <thead>
                                <tr>
                                    <th></th>
                                    {% for sr in selected_resources %}
                                        {% set r = resources_dict[sr] %}
                                        <th>
                                            <span class='badge' style='background: {{ r['color'] }}; color: #fff;'>{{r['name']}}</span>
                                        </th>
                                    {% endfor %}
                                    <th>total</th>
                                    <td>%</td>
                                    <td>View</td>
                                </tr>
                                </thead>
                                <tbody>
                                {% for entry in entries %}
                                    {% if entry['key'] == 'downtime' %}
                                        {% set color = 'color: rgb(181,4,0);' %}
                                    {% elif entry['key'] == 'maintenance' %}
                                        {% set color = 'color: rgb(255,107,53);' %}
                                    {% else %}
                                    {% endif %}
                                <tr style="{{ color }}">
                                    <td>{{ entry['label'] }}</td>
                                    {% for r in selected_resources %}
                                        <th>
                                            {% if use_data %}
                                                {{ entry['days'][r]|pretty_size}}
                                            {% else %}
                                                {{ entry['days'][r] }}
                                            {% endif %}
                                        </th>
                                    {% endfor %}
                                    <td><strong>
                                        {% if use_data %}
                                            {{ entry['total_days']|pretty_size}}
                                        {% else %}
                                            {{ entry['total_days']}}
                                        {% endif %}
                                    </strong></td>
                                    <td>{{ '%0.2f'|format(entry['total_days'] * 100 / total_usage) }}</td>
                                    <td>
                                        {% if entry['bookings'] %}
                                        <div class="col-1"><a href="javascript:selectEntryList('{{ entry['key'] }}')"><i class="fas fa-eye"></i></a></div>
                                        {% endif %}
                                    </td>
                                </tr>
                                {% endfor %}

                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="card col-12">
                    <div class="card-header">
                        <h3>Usage Distribution Plots</h3>
                    </div>
                    <div class="card-body">
                        <div class="row">
                             <div class="col-6" id="usage_pie"></div>
                            <div class="col-6" id="usage_column"></div>
                        </div>
                    </div>
                </div>



            </div>
        </div>

        <!-- CEM table -->
        <div class="col-6">
            <div class="card">
                <div class="col-12" id="entrylist-content">
                    {% include 'report_microscopes_usage_entrylist.html' %}
                </div> <!-- CEM table -->

            </div>
        </div> <!-- CEM table -->
</div>


<script>
(function(window, document, $, undefined) {
    "use strict";
    $(function() {
        var metric = {{ metric|tojson }};
        var pie_data = {{ pie_data|tojson }};
        var bar_data = {{ bar_data|tojson }};
        var drilldown = {{ drilldown_data|tojson }};
        var n = {{ selected_resources|length }};

        var columnsDef = [
            { orderable: false }
        ];
        // Add one null column specification for each resource + 2 extra columns
        for (var i = 0; i < n + 2; ++i)
            columnsDef.push(null)
        columnsDef.push({orderable: false});  // last "View" column

        if (metric == 'days')
            create_hc_usage('usage_pie', 'pie', pie_data);
        create_hc_usage('usage_column', 'column', bar_data, drilldown);

        $('#table-overall').DataTable({
            sDom: 'Blrtip',
            paging: false,
            info: false,
            order: [[ n + 2, "desc" ]],
            buttons: [
            'copy', 'csv', 'excel', 'pdf', 'print'
            ],
            columns: columnsDef
    });
});

})(window, document, window.jQuery);
</script>