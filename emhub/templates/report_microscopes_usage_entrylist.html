{% import "entry_macros.html" as macros %}

{% if selected_entry %}
    <div class="card">
       <div class="card-header">
        <div class="row">
        <h5 class="mb-0 col-8">{{ selected_entry['label'] }}</h5>
        </div>
    </div>
    <div class="card-body">
        <table id="table-entrylist" class="table table-striped table-bordered" style="width:100%">
                <thead>
                <tr>
                    <th>start</th>
                    <th>{{ metric }}</th>
                    <th>user</th>
                    <th>instrument</th>
                    <th>sessions</th>
                    <th>view</th>
                </tr>
                </thead>
                <tbody>
                {% for b in selected_entry['bookings'] %}
                    {% set r = resources_dict[b.resource.id] %}
                <tr>
                    <td>{{ b.start|pretty_date }}</td>
                    {% if use_data %}
                        {% set b_size = b.total_size %}
                        <td>{% if b_size %}{{ b_size|pretty_size }} {% endif %}</td>
                    {% else %}
                        <td>{{ b.units() if use_days else b.hours }}</td>
                    {% endif %}
                    <td>{{ b.owner.name }}</td>
                    <td><span class='badge' style='background: {{ r['color'] }}; color: #fff;'>{{r['name']}}</span></td>
                    <td>{{ macros.session_list(b.session) }}</td>
                    <td>
                        <div class="col-1"><a href="javascript:showBookingForm({booking_id: {{ b.id }}})"><i class="fas fa-eye"></i></a></div>
                    </td>
                </tr>
                {% endfor %}

                </tbody>
            </table>

    </div>
</div>
{% else %}
    <div class="card">
        <div class="card-header">
            <div class="row">
                <h5 class="mb-0 col-8">Select PI to see booking details</h5>
            </div>
        </div>
    </div>
{% endif %}

<script>
(function(window, document, $, undefined) {
    "use strict";
    $(function() {
        $('#table-entrylist').DataTable({
            sDom: 'Blrtip',
            paging: false,
            info: false,
            order: [[ 0, "desc" ]]
    });
});

})(window, document, window.jQuery);
</script>